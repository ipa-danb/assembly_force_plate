<?xml version="1.0"?>

<launch>
    <arg name="gui" default="True" />
    <arg name="frame_editor" default="True" />

    <node name="robot_pos" pkg="tf" type="static_transform_publisher" args="0.2 0.2 0.0 1 0 0 0 table base_link 2"/>
    <node name="target3_publisher" pkg="tf" type="static_transform_publisher" args="0.0 0.0 0.025 0 0 0 1 box table_zero 2"/>

    <!-- robot description -->
    <group ns="cell">
        <param name="robot_description" command="$(find xacro)/xacro '$(find teach_tool)/urdf/robot_cell.urdf.xacro'" />
        <!-- robot state publisher -->
        <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" />
    </group>
    <group ns="ur5">
        <param name="robot_description" command="$(find xacro)/xacro '$(find teach_tool)/urdf/robot_cell_ur5.urdf.xacro'"/>
        <node name="simulator" pkg="microsim" type="micro_simulator.py" output="screen">
            <param name="tool_frame" value="ur5_tool0"/>
            <param name="limit_joints" value="False"/>
            <rosparam param="initial_state">
                ur5_shoulder_pan_joint: 0.0
                ur5_shoulder_lift_joint: -1.57
                ur5_elbow_joint: 1.57
                ur5_wrist_1_joint: -1.57
                ur5_wrist_2_joint: -1.57
                ur5_wrist_3_joint: -1.57
            </rosparam>
        </node>
        <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" />

        <node name="joint_vel_republisher" pkg="microsim" type="joint_vel_republisher_node" output="screen"/>
    </group>

    <!-- republish the joint velocities from a C++ node (https://gitlab.cc-asp.fraunhofer.de/pitasc/pitasc/-/issues/367) -->

    <!-- rviz -->
    <node pkg="rviz" type="rviz" name="rviz" args="-d $(find teach_tool)/launch/teach_tool.rviz" if="$(arg gui)"/>

    <!-- frame_editor headless -->
    <!-- <node if="$(arg frame_editor)" pkg="frame_editor" type="editor.py" name="frame_editor" ns="editor1" args="- -load '$(find teach_tool)/frames.yaml'" output="screen"/> -->

    <node if="$(arg frame_editor)"
        pkg="rqt_gui" type="rqt_gui" name="frame_editor" output="screen"
        args="--standalone frame_editor --args --load 'teach_tool frames.yaml' --rate 1"/>


</launch>
